@using FlightSchoolTss.DTOs.Maintainer;
@inject IMaintainersApiClient MaintainersApiClient


<MudGrid>
    <MudItem xs="12">
        <MudText Typo="Typo.h3">Maintainers</MudText>
    </MudItem>
    <MudItem sm="8">
        <AddForm OnMaintainerAdd="RefreshMaintainers" _dto="_createMaintainerDto" />
    </MudItem>
    <MudItem xs="12">
        <MaintainerTable MaintainerName="BindMaintainerDto" MaintainerVms="_maintainers" />
    </MudItem>
</MudGrid>

@code {

    private List<MaintainerVm>? _maintainers;
    private CreateMaintainerDto _createMaintainerDto = new();

    private async Task RefreshMaintainers()
    {
        _maintainers = await MaintainersApiClient.GetMaintainersAsync();
    }
    private void BindMaintainerDto(string name)
    {
        _createMaintainerDto = new CreateMaintainerDto() { Name = name };
    }

    protected override async Task OnInitializedAsync()
    {
        await RefreshMaintainers();
    }
}